{
    "bug_id": "scikit-learn__scikit-learn-13497",
    "problem_statement": "Comparing string to array in _estimate_mi\nIn ``_estimate_mi`` there is ``discrete_features == 'auto'`` but discrete features can be an array of indices or a boolean mask.\r\nThis will error in future versions of numpy.\r\nAlso this means we never test this function with discrete features != 'auto', it seems?\n",
    "dev_patch": "diff --git a/sklearn/feature_selection/mutual_info_.py b/sklearn/feature_selection/mutual_info_.py\n--- a/sklearn/feature_selection/mutual_info_.py\n+++ b/sklearn/feature_selection/mutual_info_.py\n@@ -10,7 +10,7 @@\n from ..preprocessing import scale\n from ..utils import check_random_state\n from ..utils.fixes import _astype_copy_false\n-from ..utils.validation import check_X_y\n+from ..utils.validation import check_array, check_X_y\n from ..utils.multiclass import check_classification_targets\n \n \n@@ -247,14 +247,16 @@ def _estimate_mi(X, y, discrete_features='auto', discrete_target=False,\n     X, y = check_X_y(X, y, accept_sparse='csc', y_numeric=not discrete_target)\n     n_samples, n_features = X.shape\n \n-    if discrete_features == 'auto':\n-        discrete_features = issparse(X)\n-\n-    if isinstance(discrete_features, bool):\n+    if isinstance(discrete_features, (str, bool)):\n+        if isinstance(discrete_features, str):\n+            if discrete_features == 'auto':\n+                discrete_features = issparse(X)\n+            else:\n+                raise ValueError(\"Invalid string value for discrete_features.\")\n         discrete_mask = np.empty(n_features, dtype=bool)\n         discrete_mask.fill(discrete_features)\n     else:\n-        discrete_features = np.asarray(discrete_features)\n+        discrete_features = check_array(discrete_features, ensure_2d=False)\n         if discrete_features.dtype != 'bool':\n             discrete_mask = np.zeros(n_features, dtype=bool)\n             discrete_mask[discrete_features] = True\n",
    "our_patch": "diff --git a/sklearn/feature_selection/mutual_info_.py b/sklearn/feature_selection/mutual_info_.py\n--- a/sklearn/feature_selection/mutual_info_.py\n+++ b/sklearn/feature_selection/mutual_info_.py\n@@ -250,16 +250,15 @@\n     if discrete_features == 'auto':\n         discrete_features = issparse(X)\n \n-    if isinstance(discrete_features, bool):\n-        discrete_mask = np.empty(n_features, dtype=bool)\n-        discrete_mask.fill(discrete_features)\n-    else:\n+    if isinstance(discrete_features, (list, np.ndarray)):\n         discrete_features = np.asarray(discrete_features)\n         if discrete_features.dtype != 'bool':\n             discrete_mask = np.zeros(n_features, dtype=bool)\n             discrete_mask[discrete_features] = True\n         else:\n             discrete_mask = discrete_features\n+    else:\n+        discrete_mask = np.full(n_features, discrete_features, dtype=bool)\n \n     continuous_mask = ~discrete_mask\n     if np.any(continuous_mask) and issparse(X):\n@@ -288,6 +287,7 @@\n           x, discrete_feature in zip(_iterate_columns(X), discrete_mask)]\n \n     return np.array(mi)\n+\n \n \n def mutual_info_regression(X, y, discrete_features='auto', n_neighbors=3,\n",
    "final_iteration": 4,
    "buggy_methods": [
        "sklearn/feature_selection/mutual_info_.py::_estimate_mi"
    ],
    "num_buggy_methods": 1
}