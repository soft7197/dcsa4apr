{
    "bug_id": "django__django-14382",
    "problem_statement": "django-admin startapp with trailing slash in directory name results in error\nDescription\n\t\nBash tab-completion appends trailing slashes to directory names. django-admin startapp name directory/ results in the error:\nCommandError: '' is not a valid app directory. Please make sure the directory is a valid identifier.\nThe error is caused by â€‹line 77 of django/core/management/templates.py by calling basename() on the path with no consideration for a trailing slash:\nself.validate_name(os.path.basename(target), 'directory')\nRemoving potential trailing slashes would solve the problem:\nself.validate_name(os.path.basename(target.rstrip(os.sep)), 'directory')\n",
    "dev_patch": "diff --git a/django/core/management/templates.py b/django/core/management/templates.py\n--- a/django/core/management/templates.py\n+++ b/django/core/management/templates.py\n@@ -73,9 +73,9 @@ def handle(self, app_or_project, name, target=None, **options):\n             except OSError as e:\n                 raise CommandError(e)\n         else:\n-            if app_or_project == 'app':\n-                self.validate_name(os.path.basename(target), 'directory')\n             top_dir = os.path.abspath(os.path.expanduser(target))\n+            if app_or_project == 'app':\n+                self.validate_name(os.path.basename(top_dir), 'directory')\n             if not os.path.exists(top_dir):\n                 raise CommandError(\"Destination directory '%s' does not \"\n                                    \"exist, please create it first.\" % top_dir)\n",
    "our_patch": "diff --git a/django/core/management/templates.py b/django/core/management/templates.py\n--- a/django/core/management/templates.py\n+++ b/django/core/management/templates.py\n@@ -73,6 +73,8 @@\n             except OSError as e:\n                 raise CommandError(e)\n         else:\n+            # Remove trailing slashes from target\n+            target = target.rstrip(os.sep)\n             if app_or_project == 'app':\n                 self.validate_name(os.path.basename(target), 'directory')\n             top_dir = os.path.abspath(os.path.expanduser(target))\n@@ -181,6 +183,7 @@\n                     os.remove(path_to_remove)\n                 else:\n                     shutil.rmtree(path_to_remove)\n+\n \n     def handle_template(self, template, subdir):\n         \"\"\"\n",
    "final_iteration": 1,
    "buggy_methods": [
        "django/core/management/templates.py::handle"
    ],
    "num_buggy_methods": 1
}